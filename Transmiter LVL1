from RF24 import RF24
import time
import os

# Set up the RF24 communication
radio = RF24(22, 0)  # CE, CSN pins (update based on your pin setup)
radio.begin()
radio.setPALevel(RF24.PA_HIGH)
radio.openWritingPipe(0xF0F0F0F0E1)  # Unique pipe address
radio.stopListening()

# Function to send the image
def send_image(image_path):
    with open(image_path, "rb") as f:
        image_data = f.read()
    
    print(f"Sending {len(image_data)} bytes of image data...")

    # Send the data in chunks
    chunk_size = 32  # Maximum payload size for NRF24L01
    total_chunks = (len(image_data) // chunk_size) + 1
    
    # First, send the total number of chunks
    header = str(total_chunks).encode().ljust(chunk_size, b'\0')  # Pad to 32 bytes
    radio.write(header)
    time.sleep(0.2)  # Allow receiver to process
    
    # Sending chunks
    for i in range(0, len(image_data), chunk_size):
        chunk = image_data[i:i+chunk_size]
        radio.write(chunk)
        print(f"Sent chunk {i//chunk_size + 1} of {total_chunks}")
        time.sleep(0.05)  # Small delay to ensure smooth transmission

    print("Image transmission complete!")

# Specify the path to your image
image_path = "image_to_send.jpg"
send_image(image_path)

